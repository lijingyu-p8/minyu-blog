import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";import{o as p,c as o,a as n,d as t,e as s,b as i,r as l}from"./app.f751154e.js";var c="/minyu-blog/ElasticSearch/03/char_filter_1.png",u="/minyu-blog/ElasticSearch/03/tokenizer_1.png",r="/minyu-blog/ElasticSearch/03/store-1.png",d="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u67E5\u8BE21.png",v="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u67E5\u8BE22.png",m="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u67E5\u8BE24.jpg",k="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u67E5\u8BE23.jpg",b="/minyu-blog/ElasticSearch/03/\u5199\u5165\u539F\u7406.png",q="/minyu-blog/ElasticSearch/03/segment-1.png",g="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u5206\u7247\u538B\u7F29-1.png",y="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u5206\u7247\u538B\u7F29-2.png",_="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u5206\u7247\u538B\u7F29-3.png",h="/minyu-blog/ElasticSearch/03/\u7D22\u5F15\u5206\u7247\u538B\u7F29-4.png",x="/minyu-blog/ElasticSearch/03/rollover-1.png",f="/minyu-blog/ElasticSearch/03/stats-1.png";const j={},E=s(`<h1 id="elasticsearch\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#elasticsearch\u7D22\u5F15" aria-hidden="true">#</a> Elasticsearch\u7D22\u5F15</h1><h2 id="\u4E00\u3001\u7D22\u5F15\u76F8\u5173\u7EC4\u6210" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001\u7D22\u5F15\u76F8\u5173\u7EC4\u6210" aria-hidden="true">#</a> \u4E00\u3001\u7D22\u5F15\u76F8\u5173\u7EC4\u6210</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT index-name(\u7D22\u5F15name)
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;NAME&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-1\u3001setting" tabindex="-1"><a class="header-anchor" href="#_1-1\u3001setting" aria-hidden="true">#</a> 1.1\u3001setting</h3><h4 id="_1-1-1\u3001\u57FA\u672C\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-1-1\u3001\u57FA\u672C\u914D\u7F6E" aria-hidden="true">#</a> 1.1.1\u3001\u57FA\u672C\u914D\u7F6E</h4><ul><li>\u8BBE\u7F6E\u540E\u4E0D\u53EF\u66F4\u6539 <ol><li>number_of_shards\uFF1A\u4E3B\u5206\u7247\u4E2A\u6570\uFF087.x\u4EE5\u540E\u9ED8\u8BA4\u662F1\uFF0C\u4EE5\u524D\u9ED8\u8BA4\u662F5\uFF09\uFF0C\u6BCF\u4E2A\u7D22\u5F15\u5206\u7247\u6570\u91CF\u4E0A\u9650\uFF1A1024\u3002</li><li>codec\uFF1A\u5B58\u50A8\u65F6\u6570\u636E\u7684\u538B\u7F29\u7B56\u7565\uFF0C\u53EF\u8BBE\u7F6E\u4E3Abest_compression\uFF08\u538B\u7F29\u5143\u6570\u636E\uFF0C\u4F1A\u964D\u4F4E\u6027\u80FD\uFF09\u3002\u9ED8\u8BA4\u662Fdefault\uFF0C\u4E0D\u538B\u7F29\u3002</li><li>blocks.read_only\uFF1A\u8BBE\u7F6E\u4E3Atrue\u53EF\u4F7F\u7D22\u5F15\u548C\u7D22\u5F15\u5143\u6570\u636E\u4E3A\u53EA\u8BFB\uFF0C\u8BBE\u7F6E\u4E3Afalse\u53EF\u5141\u8BB8\u5199\u5165\u548C\u5143\u6570\u636E\u66F4\u6539\u3002</li><li>blocks.read\uFF1A\u8BBE\u7F6E\u4E3Atrue\u4EE5\u7981\u7528\u5BF9\u7D22\u5F15\u7684\u8BFB\u53D6\u64CD\u4F5C\u3002</li><li>blocks.write\uFF1A\u8BBE\u7F6E\u4E3Atrue\u4EE5\u7981\u7528\u9488\u5BF9\u7D22\u5F15\u7684\u6570\u636E\u5199\u5165\u64CD\u4F5C\u3002</li><li>blocks.metadata\uFF1A\u8BBE\u7F6E\u4E3Atrue\u4EE5\u7981\u7528\u7D22\u5F15\u5143\u6570\u636E\u8BFB\u53D6\u548C\u5199\u5165\u3002</li></ol></li><li>\u8BBE\u7F6E\u540E\u53EF\u91CD\u590D\u4FEE\u6539 <ol><li>number_of_replicas\uFF1A\u4E3A\u6BCF\u4E2A\u4E3B\u5206\u7247\u5206\u914D\u7684\u526F\u672C\u4E2A\u6570\uFF0C\u9ED8\u8BA4\u662F1\u3002</li><li>auto_expand_replicas\uFF1A\u6839\u636E\u96C6\u7FA4\u4E2D\u6570\u636E\u8282\u70B9\u7684\u6570\u91CF\u81EA\u52A8\u6269\u5C55\u526F\u672C\u7684\u6570\u91CF\u3002\u8BBE\u7F6E\u4E3A\u4EE5\u77ED\u5212\u7EBF\u5206\u9694\u7684\u4E0A\u4E0B\u9650\uFF08\u4F8B\u59820-5\uFF09\u6216all \u7528\u4E8E\u4E0A\u9650\uFF08\u4F8B\u59820-all\uFF09\u3002\u9ED8\u8BA4\u4E3Afalse\uFF08\u5373\u7981\u7528\uFF09\u3002</li><li>max_result_window\uFF1A\u641C\u7D22\u5230\u6B64\u7D22\u5F15\u7684from+size\u7684\u6700\u5927\u503C\u3002\u9ED8\u8BA4\u503C\u4E3A10000\u3002\u641C\u7D22\u8BF7\u6C42\u5360\u7528\u7684\u5806\u5185\u5B58\u548C\u65F6\u95F4\u4E0Efrom+size\u6210\u6BD4\u4F8B\uFF0C\u8FD9\u9650\u5236\u4E86\u8BE5\u5185\u5B58\u3002</li><li>max_rescore_window\uFF1A</li></ol></li></ul><h4 id="_1-1-2\u3001\u5206\u6790\u5668" tabindex="-1"><a class="header-anchor" href="#_1-1-2\u3001\u5206\u6790\u5668" aria-hidden="true">#</a> 1.1.2\u3001\u5206\u6790\u5668</h4><ul><li><p>\u5206\u6790\u5668\u56DB\u5927\u7EC4\u6210\u90E8\u5206</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT product2
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><ol><li><p>char_filter</p><ul><li><p>\u5B57\u7B26\u8FC7\u6EE4\u5668\uFF1A\u5206\u8BCD\u4E4B\u524D\u7684\u9884\u5904\u7406\uFF0C\u5305\u62EC\u8FC7\u6EE4\u65E0\u7528\u5B57\u7B26\u3001\u6807\u7B7E\uFF0C\u8F6C\u6362\u5B57\u7B26\uFF0C\u6BD4\u5982A\u66FF\u6362\u4E3AB\u3001&amp;=&gt;and</p></li><li><p>\u4E09\u79CD\u7C7B\u578B\uFF1AHTML strip\u3001Mapping\u3001Pattern replace</p></li><li><p>HTML strip</p><p>\u53BB\u6389\u7C7B\u4F3Cb\u3001a\u6807\u7B7E\u8FD9\u6837\u7684HTML\u6807\u7B7E\uFF0C\u5E76\u4E14\u53EF\u4EE5\u901A\u8FC7escaped_tags\u53C2\u6570\uFF0C\u914D\u7F6E\u6307\u5B9A\u54EA\u4E9B\u6807\u7B7E\u4E0D\u8FC7\u6EE4\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /my-index
{
  &quot;settings&quot;: {
    &quot;analysis&quot;: {
      &quot;analyzer&quot;: {
        &quot;my_analyzer&quot;: {
          &quot;tokenizer&quot;: &quot;keyword&quot;,
          &quot;char_filter&quot;: [
            &quot;my_char_filter&quot;
          ]
        }
      },
      &quot;char_filter&quot;: {//\u81EA\u5B9A\u4E49char_filter
        &quot;my_char_filter&quot;:{
          &quot;type&quot;:&quot;html_strip&quot;,
          &quot;escaped_tags&quot;:[&quot;p&quot;]//\u53BB\u6389html\u6807\u7B7E\u7684\u65F6\u5019\uFF0C\u5FFD\u7565p
        }
      }
    }
  }
}
GET my-index/_analyze
{
  &quot;analyzer&quot;: &quot;my_analyzer&quot;,
  &quot;text&quot;: &quot;&lt;p&gt;I&amp;apos;m so &lt;b&gt;happy&lt;/b&gt;!&lt;/p&gt;&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+c+`" alt="char_filter_1"></p></li><li><p>Mapping</p><p>\u914D\u7F6E\u6307\u5B9A\u5B57\u7B26\u4E32\u7684\u66FF\u6362\u89C4\u5219\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;my_char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mapping&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
				<span class="token string">&quot;p =&gt; AAAA&quot;</span><span class="token punctuation">,</span><span class="token comment">//p\u66FF\u6362\u4E3AAAAA</span>
				<span class="token string">&quot;h =&gt; BBBB&quot;</span> <span class="token comment">//h\u66FF\u6362\u4E3ABBBB</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Pattern replace</p><p>\u6B63\u5219\u8868\u8FBE\u5F0F\u5339\u914D\uFF0Cpattern\u53C2\u6570\u914D\u7F6E\u6B63\u5219\uFF0Creplacement\u53C2\u6570\u914D\u7F6E\u6B63\u5219\u66FF\u6362\u7684\u5B57\u7B26\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;my_char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pattern_replace&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;pattern&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\\\\d&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;replacement&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-Q-&quot;</span><span class="token comment">//\u5C06\u5339\u914D\u7684\u4EFB\u610F\u6570\u5B57\uFF0C\u66FF\u6362\u4E3A-Q-</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>filter</p><p>\u53EF\u4EE5\u5BF9\u6570\u636E\u505A\u4E00\u5B9A\u7684\u4FEE\u6539\uFF0C\u6BD4\u5982\u505C\u7528\u8BCD\u3001\u65F6\u6001\u8F6C\u6362\u3001\u5927\u5C0F\u5199\u8F6C\u6362\u3001\u540C\u4E49\u8BCD\u8F6C\u6362\u3001\u8BED\u6C14\u8BCD\u5904\u7406\u7B49\u3002\u6BD4\u5982\uFF1Ahas=&gt;have\u3001him=&gt;he apples=&gt;apple\u3001the/oh/a=&gt;\u5E72\u6389\u3002</p><p>lowercase\uFF1A\u628A\u82F1\u6587\u5B57\u7B26\u5168\u90E8\u8F6C\u4E3A\u5C0F\u5199\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;tokenizer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;filter&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;THE Quick FoX JUMPs&quot;</span> <span class="token comment">//\u7ED3\u679C\u5168\u4E3A\u5C0F\u5199\u3002</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>tokenizer</p><p>\u5206\u8BCD\u5668\uFF0C\u9ED8\u8BA4\u7684\u662Fstandard\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /my-index<span class="token number">-10</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;my_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_tokenizer&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;my_tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u9ED8\u8BA4\u5730\u82F1\u6587\u5206\u8BCD\u5668</span>
          <span class="token property">&quot;max_token_length&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token comment">//\u6700\u5927\u5206\u8BCD\u7684\u957F\u5EA6\uFF0C\u9ED8\u8BA4255</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u793A\u4F8B\uFF1A\u6B63\u5219\u5339\u914D\u5206\u9694\u7B26\uFF1Apattern\uFF0C\u5C06\u6587\u672C\u5206\u6210\u82E5\u5E72\u8BCD\u9879\u3002</p><p>\u200B &quot;flags&quot;:&quot;CASE_INSENSITIVE&quot; \u5339\u914D\u7684\u65F6\u5019\u5FFD\u7565\u5927\u5C0F\u5199\u3002\uFF08\u53EF\u9009\u9879\uFF09</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /my-index<span class="token number">-13</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;my_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_tokenizer&quot;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;my_tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pattern&quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;pattern&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u6B63\u5219\u5339\u914D\uFF0C\u6309\u7167a\u8FDB\u884C\u5206\u8BCD</span>
					<span class="token property">&quot;flags&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CASE_INSENSITIVE&quot;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

GET my-index<span class="token number">-13</span>/_analyze
<span class="token punctuation">{</span>
	<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_analyzer&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xiaomi,so,xiAomi cool,hhhhhh&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+u+`" alt="image-20210808231513059"></p><p>\u793A\u4F8B\uFF1A\u6B63\u5219\u5339\u914D\u8BCD\u9879\uFF1Asimple_pattern</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT my-index<span class="token number">-14</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;my_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_tokenizer&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;my_tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;simple_pattern&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;pattern&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[0123456789]{3}&quot;</span><span class="token comment">//\u5339\u914D\u4E09\u4F4D\u7684\u6570\u5B57</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
POST my-index<span class="token number">-14</span>/_analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_analyzer&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fd-786-335-514-x&quot;</span>
<span class="token punctuation">}</span>
\u5339\u914D\u7ED3\u679C\uFF1A<span class="token number">786</span>  <span class="token number">335</span>  <span class="token number">514</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>analyzer</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /my_index
<span class="token punctuation">{</span>
	<span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;&amp;_to_and&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mapping&quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&amp;=&gt; and &quot;</span><span class="token punctuation">]</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;my_stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;the&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;my_tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;max_token_length&quot;</span><span class="token operator">:</span> <span class="token number">4</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;my_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;html_strip&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&amp;_to_and&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
					<span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;my_tokenizer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
					<span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;my_stopwords&quot;</span><span class="token punctuation">]</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_1-2\u3001mapping" tabindex="-1"><a class="header-anchor" href="#_1-2\u3001mapping" aria-hidden="true">#</a> 1.2\u3001Mapping</h3><p>\u200B \u6620\u5C04\u662F\u5B9A\u4E49\u6587\u6863\u53CA\u5176\u5305\u542B\u7684\u5B57\u6BB5\u5982\u4F55\u5B58\u50A8\u548C\u7D22\u5F15\u7684\u8FC7\u7A0B\u3002\u6BCF\u4E2A\u6587\u6863\u90FD\u662F\u4E00\u6279\u5B57\u6BB5\u7684\u96C6\u5408\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u90FD\u6709\u81EA\u5DF1\u7684\u6570\u636E\u7C7B\u578B\u3001\u9ED8\u8BA4\u503C\u3001\u5206\u6790\u5668\u3001\u662F\u5426\u88AB\u7D22\u5F15\u7B49\u7B49\u914D\u7F6E\u4FE1\u606F\u3002\u8FD9\u4E9B\u90FD\u662F\u6620\u5C04\u91CC\u9762\u53EF\u4EE5\u8BBE\u7F6E\u7684\uFF0C\u6309\u7167\u6700\u4F18\u89C4\u5219\u5904\u7406\u6570\u636E\u5BF9ES\u6027\u80FD\u63D0\u9AD8\u5F88\u5927\uFF0C\u56E0\u6B64\u624D\u9700\u8981\u5EFA\u7ACB\u6620\u5C04\uFF0C\u5E76\u4E14\u9700\u8981\u601D\u8003\u5982\u4F55\u5EFA\u7ACB\u6620\u5C04\u624D\u80FD\u5BF9\u6027\u80FD\u66F4\u597D\u3002</p><p>\u200B \u6620\u5C04\u5206\u4E3A\u52A8\u6001\u6620\u5C04\u548C\u663E\u793A\u6620\u5C04\u3002\u5728dynamic mapping\u52A8\u6001\u521B\u5EFA\u7684\u65F6\u5019\uFF0CES\u4F1A\u6839\u636Eput\u7684\u6570\u636E\uFF0C\u81EA\u52A8\u4E3A\u76F8\u5E94\u7684\u5B57\u6BB5\u521B\u5EFA\u7C7B\u578B\u3001\u641C\u7D22\u65B9\u5F0F\uFF08exact value\u6216\u8005full text\uFF09\u3001\u5206\u8BCD\u5668\u7B49\u3002</p>`,12),z=s("<li><p>exact value\uFF1A\u7CBE\u786E\u5339\u914D\uFF0C\u5728\u5012\u6392\u7D22\u5F15\u8FC7\u7A0B\u4E2D\uFF0C\u5206\u8BCD\u5668\u4F1A\u5C06field\u4F5C\u4E3A\u4E00\u4E2A\u6574\u4F53\u521B\u5EFA\u5230\u7D22\u5F15\u4E2D\u3002</p></li><li><p>full text\uFF1A\u5168\u6587\u68C0\u7D22\u3002\u5206\u8BCD\u3001\u8FD1\u4E49\u8BCD\u3001\u540C\u4E49\u8BCD\u3001\u6DF7\u6DC6\u8BCD\u3001\u5927\u5C0F\u5199\u3001\u8BCD\u6027\u3001\u8FC7\u6EE4\u3001\u65F6\u6001\u8F6C\u6362\u7B49\u3002</p></li><li><p>\u52A8\u6001\u6620\u5C04</p><table><thead><tr><th>123456</th><th>=&gt;</th><th>long</th></tr></thead><tbody><tr><td>123.123</td><td>=&gt;</td><td>double</td></tr><tr><td>true|false</td><td>=&gt;</td><td>boolean</td></tr><tr><td>2020-05-20</td><td>=&gt;</td><td>date</td></tr></tbody></table><p>ES\u662F\u4F7F\u7528JSON\u5206\u6790\u5668\u8FDB\u884C\u5B57\u6BB5\u7C7B\u578B\u68C0\u6D4B\u7684\uFF0CJSON\u6CA1\u6709\u9690\u5F0F\u8F6C\u6362\uFF0C\u6240\u4EE5\u4F1A\u5BF9\u5B57\u6BB5\u8BBE\u7F6E\u4E00\u4E2A\u6BD4\u8F83\u5BBD\u7684\u5B57\u6BB5\u7C7B\u578B\uFF0Cinteger\u7684\u4F1A\u8BBE\u7F6E\u4E3Along</p></li>",3),S=n("p",null,"type\u6838\u5FC3\u7C7B\u578B\uFF08\u5B57\u6BB5\u7C7B\u578B\uFF09",-1),T=s(`<li><p>\u6570\u5B57\u7C7B\u578B</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>long, integer, short, byte, double, float, half_float, scaled_float
\u5728\u6EE1\u8DB3\u9700\u6C42\u7684\u60C5\u51B5\u4E0B\uFF0C\u5C3D\u53EF\u80FD\u9009\u62E9\u8303\u56F4\u5C0F\u7684\u6570\u636E\u7C7B\u578B\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>text\u7C7B\u578B</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>keyword\uFF1A
  \u9002\u7528\u4E8E\u7D22\u5F15\u7ED3\u6784\u5316\u7684\u5B57\u6BB5\uFF0C\u53EF\u4EE5\u7528\u4E8E\u8FC7\u6EE4\u3001\u6392\u5E8F\u3001\u805A\u5408\u3002keyword\u7C7B\u578B\u7684\u5B57\u6BB5\u53EA\u80FD\u901A\u8FC7\u7CBE\u786E\u503C\uFF08exact value\uFF09\u641C\u7D22\u5230\u3002Id\u5E94\u8BE5\u7528keyword\u3002
text\uFF1A
  \u5F53\u4E00\u4E2A\u5B57\u6BB5\u662F\u8981\u88AB\u5168\u6587\u641C\u7D22\u7684\uFF0C\u6BD4\u5982Email\u5185\u5BB9\u3001\u4EA7\u54C1\u63CF\u8FF0\uFF0C\u8FD9\u4E9B\u5B57\u6BB5\u5E94\u8BE5\u4F7F\u7528text\u7C7B\u578B\u3002\u8BBE\u7F6Etext\u7C7B\u578B\u4EE5\u540E\uFF0C\u5B57\u6BB5\u5185\u5BB9\u4F1A\u88AB\u5206\u6790\uFF0C\u5728\u751F\u6210\u5012\u6392\u7D22\u5F15\u4EE5\u524D\uFF0C\u5B57\u7B26\u4E32\u4F1A\u88AB\u5206\u6790\u5668\u5206\u6210\u4E00\u4E2A\u4E00\u4E2A\u8BCD\u9879\u3002text\u7C7B\u578B\u7684\u5B57\u6BB5\u4E0D\u7528\u4E8E\u6392\u5E8F\uFF0C\u5F88\u5C11\u7528\u4E8E\u805A\u5408\u3002
  \u4E3A\u5565\u4E0D\u4F1A\u4E3Atext\u521B\u5EFA\u7D22\u5F15\uFF1A\u5B57\u6BB5\u6570\u636E\u4F1A\u5360\u7528\u5927\u91CF\u5806\u7A7A\u95F4\uFF0C\u5C24\u5176\u662F\u5728\u52A0\u8F7D\u9AD8\u57FA\u6570text\u5B57\u6BB5\u65F6\u3002\u5B57\u6BB5\u6570\u636E\u4E00\u65E6\u52A0\u8F7D\u5230\u5806\u4E2D\uFF0C\u5C31\u5728\u8BE5\u5B57\u6BB5\u7684\u751F\u547D\u5468\u671F\u5185\u4FDD\u6301\u5728\u90A3\u91CC\u3002\u540C\u6837\uFF0C\u52A0\u8F7D\u5B57\u6BB5\u6570\u636E\u662F\u4E00\u4E2A\u6602\u8D35\u7684\u8FC7\u7A0B\uFF0C\u53EF\u80FD\u5BFC\u81F4\u7528\u6237\u9047\u5230\u5EF6\u8FDF\u95EE\u9898\u3002\u8FD9\u5C31\u662F\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u7981\u7528\u5B57\u6BB5\u6570\u636E\u7684\u539F\u56E0\u3002\u6709\u65F6\uFF0C\u5728\u540C\u4E00\u5B57\u6BB5\u4E2D\u540C\u65F6\u5177\u6709\u5168\u6587\u672C\uFF08text\uFF09\u548C\u5173\u952E\u5B57\uFF08keyword\uFF09\u4F1A\u5F88\u6709\u7528\uFF1A\u4E00\u4E2A\u7528\u4E8E\u5168\u6587\u672C\u641C\u7D22\uFF0C\u53E6\u4E00\u4E2A\u7528\u4E8E\u805A\u5408\u548C\u6392\u5E8F\u3002
  ES\u9ED8\u8BA4\u4F1A\u4E3Atext\u5B57\u7B26\u7C7B\u578B\u5B57\u6BB5\u521B\u5EFAkeyword,\u5E76\u4E14ignore_above\u5C5E\u6027\u8BBE\u7F6E\u4E3A256\u3002\u9ED8\u8BA4\u53EA\u53D6\u524D256\u4E2A\u5B57\u7B26\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fields&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;ignore_above&quot;</span> <span class="token operator">:</span> <span class="token number">256</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,2),w=n("p",null,"date\u7C7B\u578B",-1),P=n("p",null,"date\u7C7B\u578B\u5C5E\u4E8Eexact value\u3002\u4E0D\u4F1A\u88AB\u5206\u8BCD\u3002",-1),U={href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.10/date.html",target:"_blank",rel:"noopener noreferrer"},A=n("code",null,"date",-1),I=i("\u548C "),B={href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.10/date_nanos.html",target:"_blank",rel:"noopener noreferrer"},M=n("code",null,"date_nanos",-1),N=s(`<li><p>\u5E03\u5C14\u7C7B\u578B</p></li><li><p>binary\uFF08\u4E8C\u8FDB\u5236\uFF09</p></li><li><p>range\uFF08\u533A\u95F4\u7C7B\u578B\uFF09</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>integer_range\u3001float_range\u3001long_range\u3001double_range\u3001date_range
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u590D\u6742\u7C7B\u578BObject</p><p>\u7528\u4E8E\u5355\u4E2Ajson\u5BF9\u8C61\u3002</p></li><li><p>\u590D\u6742\u7C7B\u578BNested</p><p>\u7528\u4E8E\u591A\u4E2Ajson\u6570\u7EC4\u3002</p></li>`,5),O=s(`<li><p>\u5B57\u6BB5\u7684properties\u5C5E\u6027\u914D\u7F6E</p><ol><li><p>index</p><p>\u662F\u5426\u5BF9\u5F53\u524D\u5B57\u6BB5\u521B\u5EFA\u7D22\u5F15\uFF0C\u9ED8\u8BA4true\uFF0C\u5982\u679C\u4E0D\u521B\u5EFA\u7D22\u5F15\uFF0C\u8BE5\u5B57\u6BB5\u4E0D\u4F1A\u901A\u8FC7\u7D22\u5F15\u88AB\u641C\u7D22\u5230,\u4F46\u662F\u4ECD\u7136\u4F1A\u5728source\u5143\u6570\u636E\u4E2D\u5C55\u793A\u3002</p></li><li><p>analyzer</p><p>\u6307\u5B9A\u5206\u8BCD\u5668\uFF0C\u6BD4\u5982standard\u3001english\u3001ik_max_word\u7B49\u3002\u9ED8\u8BA4\u4E3Astandard\u3002</p></li><li><p>boost</p><p>\u5BF9\u5F53\u524D\u5B57\u6BB5\u76F8\u5173\u5EA6\u7684\u8BC4\u5206\u6743\u91CD\uFF0C\u9ED8\u8BA41\uFF0C\u6743\u91CD\u8D8A\u9AD8\uFF0C\u5728\u591A\u5B57\u6BB5\u591A\u6761\u4EF6\u641C\u7D22\u65F6\uFF0C\u76F8\u5173\u5EA6\u6240\u5360\u6743\u91CD\u6BD4\u4F8B\u5C31\u4F1A\u8D8A\u9AD8\u3002</p></li><li><p>coerce</p><p>\u662F\u5426\u5141\u8BB8\u5F3A\u5236\u7C7B\u578B\u8F6C\u6362\uFF0Ctrue \u201C1\u201D=&gt; 1 false \u201C1\u201D=&lt; 1\uFF0C\u9ED8\u8BA4\u4E3Atrue\u3002</p></li><li><p>copy_to</p><p>\u8BE5\u5B57\u6BB5\u662F\u628A\u5176\u4ED6\u5B57\u6BB5\u4E2D\u7684\u503C\uFF0C\u4EE5\u7A7A\u683C\u4E3A\u5206\u9694\u7B26\u7EC4\u6210\u4E00\u4E2A\u5927\u5B57\u7B26\u4E32\uFF0C\u7136\u540E\u88AB\u5206\u6790\u548C\u7D22\u5F15\u4F46\u662F\u4E0D\u5B58\u50A8\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5B83\u80FD\u88AB\u67E5\u8BE2\uFF0C\u4F46\u662F\u4E0D\u80FD\u88AB\u53D6\u56DE\u663E\u793A\u3002\u6CE8\u610Fcopy_to\u6307\u5411\u7684\u5B57\u6BB5\uFF0C\u5B57\u6BB5\u7C7B\u578B\u8981\u4E3Atext\u3002\u5982\u679C\u60F3\u8981\u67E5\u8BE2\u663E\u793A\uFF0C\u53EF\u4EE5\u8BBE\u7F6Estore=true\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;copy_to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;full_name&quot;</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;copy_to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;full_name&quot;</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

PUT my-index<span class="token number">-000001</span>/_doc/<span class="token number">1</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span>
<span class="token punctuation">}</span>

GET my-index<span class="token number">-000001</span>/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Smith&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;and&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>doc_values</p><p>\u4E3A\u4E86\u63D0\u5347\u6392\u5E8F\u548C\u805A\u5408\u6548\u7387\uFF0C\u9ED8\u8BA4true\uFF0C\u4E3A\u5B57\u6BB5\u521B\u5EFA\u6B63\u6392\u7D22\u5F15\u3002\u5982\u679C\u786E\u5B9A\u4E0D\u9700\u8981\u5BF9\u5B57\u6BB5\u8FDB\u884C\u6392\u5E8F\u6216\u805A\u5408\uFF0C\u4E5F\u4E0D\u9700\u8981\u4ECE\u811A\u672C\u8BBF\u95EE\u5B57\u6BB5\u503C\uFF0C\u5219\u53EF\u4EE5\u7981\u7528doc\u503C\u4EE5\u8282\u7701\u78C1\u76D8\u7A7A\u95F4\uFF08\u4E0D\u652F\u6301text\u548Cannotated_text\uFF09\u3002</p></li><li><p>enable</p><p>\u662F\u5426\u521B\u5EFA\u5012\u6392\u7D22\u5F15\uFF0C\u53EF\u4EE5\u5BF9\u5B57\u6BB5\u64CD\u4F5C\uFF0C\u4E5F\u53EF\u4EE5\u5BF9\u7D22\u5F15\u64CD\u4F5C\uFF0C\u5982\u679C\u4E0D\u521B\u5EFA\u7D22\u5F15\uFF0C\u4ECD\u7136\u53EF\u4EE5\u68C0\u7D22\u5E76\u5728_source\u5143\u6570\u636E\u4E2D\u5C55\u793A\uFF0C\u8C28\u614E\u4F7F\u7528\uFF0C\u8BE5\u72B6\u6001\u65E0\u6CD5\u4FEE\u6539\u3002type\u4E3Aobject\u65F6\u53EF\u4EE5\u4F7F\u7528\u3002</p></li><li><p>fielddata</p><p>\u67E5\u8BE2\u65F6\u5185\u5B58\u6570\u636E\u7ED3\u6784\uFF0C\u5728\u9996\u6B21\u7528\u5F53\u524D\u5B57\u6BB5\u805A\u5408\u3001\u6392\u5E8F\u6216\u8005\u5728\u811A\u672C\u4E2D\u4F7F\u7528\u65F6\uFF0C\u9700\u8981\u5B57\u6BB5\u4E3Afielddata\u6570\u636E\u7ED3\u6784\uFF0C\u5E76\u4E14\u521B\u5EFA\u6B63\u6392\u7D22\u5F15\u4FDD\u5B58\u5230\u5806\u4E2D\u3002</p></li><li><p>format</p><p>\u683C\u5F0F\u5316&quot;format&quot;: &quot;yyyy-MM-dd&quot;</p></li><li><p>eager_global_ordinals</p><p>\u7528\u4E8E\u805A\u5408\u7684\u5B57\u6BB5\u4E0A\uFF0C\u4F18\u5316\u805A\u5408\u6027\u80FD,</p></li><li><p>Frozen indices\uFF08\u51BB\u7ED3\u7D22\u5F15\uFF09</p><p>\u6709\u4E9B\u7D22\u5F15\u4F7F\u7528\u7387\u5F88\u9AD8\uFF0C\u4F1A\u88AB\u4FDD\u5B58\u5728\u5185\u5B58\u4E2D\uFF0C\u6709\u4E9B\u4F7F\u7528\u7387\u7279\u522B\u4F4E\uFF0C\u5B81\u613F\u5728\u4F7F\u7528\u7684\u65F6\u5019\u91CD\u65B0\u521B\u5EFA\uFF0C\u5728\u4F7F\u7528\u5B8C\u6BD5\u540E\u4E22\u5F03\u6570\u636E\uFF0CFrozen indices\u7684\u6570\u636E\u547D\u4E2D\u9891\u7387\u5C0F\uFF0C\u4E0D\u9002\u7528\u4E8E\u9AD8\u641C\u7D22\u8D1F\u8F7D\uFF0C\u6570\u636E\u4E0D\u4F1A\u88AB\u4FDD\u5B58\u5728\u5185\u5B58\u4E2D\uFF0C\u5806\u7A7A\u95F4\u5360\u7528\u6BD4\u666E\u901A\u7D22\u5F15\u5C11\u5F97\u591A\uFF0CFrozen indices\u662F\u53EA\u8BFB\u7684\uFF0C\u8BF7\u6C42\u53EF\u80FD\u662F\u79D2\u7EA7\u6216\u8005\u5206\u949F\u7EA7\u3002eager_global_ordinals\u4E0D\u9002\u7528\u4E8EFrozen indices\u3002</p></li><li><p>fields</p><p>\u7ED9field\u521B\u5EFA\u591A\u5B57\u6BB5\uFF0C\u7528\u4E8E\u4E0D\u540C\u76EE\u7684\uFF08\u5168\u6587\u68C0\u7D22\u6216\u8005\u805A\u5408\u5206\u6790\u6392\u5E8F\uFF09\u3002</p></li><li><p>ignore_above</p><p>\u8D85\u8FC7\u957F\u5EA6\u5C06\u88AB\u5FFD\u7565</p></li><li><p>search_analyzer</p><p>\u8BBE\u7F6E\u5355\u72EC\u7684\u67E5\u8BE2\u65F6\u5206\u6790\u5668</p></li><li><p>ignore_malforme</p><p>\u5FFD\u7565\u7C7B\u578B\u9519\u8BEF</p></li><li><p>index_options</p><p>\u63A7\u5236\u5C06\u54EA\u4E9B\u4FE1\u606F\u6DFB\u52A0\u5230\u53CD\u5411\u7D22\u5F15\u4E2D\u4EE5\u8FDB\u884C\u641C\u7D22\u548C\u7A81\u51FA\u663E\u793A\u3002\u4EC5\u7528\u4E8Etext\u5B57\u6BB5</p></li><li><p>Index_phrases</p><p>\u63D0\u5347exact_value\u67E5\u8BE2\u901F\u5EA6\uFF0C\u4F46\u662F\u8981\u6D88\u8017\u66F4\u591A\u78C1\u76D8\u7A7A\u95F4</p></li><li><p>Index_prefixes</p><p>\u524D\u7F00\u641C\u7D22</p></li><li><p>min_chars</p><p>\u524D\u7F00\u6700\u5C0F\u957F\u5EA6\uFF0C&gt;0\uFF0C\u9ED8\u8BA42\uFF08\u5305\u542B\uFF09</p></li><li><p>max_chars</p><p>\u524D\u7F00\u6700\u5927\u957F\u5EA6\uFF0C&lt;20\uFF0C\u9ED8\u8BA45\uFF08\u5305\u542B\uFF09</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;index_prefixes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;min_chars&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">&quot;max_chars&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>norms</p><p>\u662F\u5426\u7981\u7528\u8BC4\u5206\uFF08\u5728filter\u548C\u805A\u5408\u5B57\u6BB5\u4E0A\u5E94\u8BE5\u7981\u7528\uFF09\u3002</p></li><li><p>null_value</p><p>\u4E3Anull\u503C\u8BBE\u7F6E\u9ED8\u8BA4\u503C\uFF0C&quot;null_value&quot;: &quot;NULL&quot;</p></li><li><p>similarity</p><p>\u76F8\u5173\u5EA6\u8BC4\u5206\u7B97\u6CD5\u3002</p><p>BM25\uFF1A\u6982\u7387\u76F8\u5173\u6027\u6A21\u578B\uFF085.0\u4E4B\u540E\uFF08\u5305\u62EC\uFF09\u9ED8\u8BA4\u7B97\u6CD5\uFF09</p><p>classic\uFF1A\u7A7A\u95F4\u5411\u91CF\u6A21\u578B\uFF08\u5411\u91CF\u7A7A\u95F4\u6A21\u578B\uFF09\uFF0CTF-IDF\uFF085.0\u4E4B\u524D\uFF09</p><p>boolean\uFF1A</p></li><li><p>store&amp;_source</p><p>\u5B57\u6BB5\u5C5E\u6027\u8BBE\u7F6Estore=true\uFF0CES\u4F1A\u5F00\u8F9F\u53E6\u4E00\u5757\u5B58\u50A8\u7A7A\u95F4\uFF0C\u5C06\u5B57\u6BB5\u6570\u636E\u5355\u72EC\u5B58\u50A8\uFF0C\u4E0E\u539F\u59CB\u6570\u636E\u5206\u79BB\uFF0C\u5F53\u53EA\u67E5\u8BE2store=true\u7684\u5B57\u6BB5\u65F6\uFF0C\u53EF\u4EE5\u8282\u7701\u5E26\u5BBD\u3002\u867D\u7136_source\u5C5E\u6027\u53EF\u4EE5\u6307\u5B9A\u8FD4\u56DE\u7684\u5143\u6570\u636E\u90FD\u5305\u542B\u54EA\u4E9B\u5B57\u6BB5\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u5728\u5B57\u6BB5\u8FC7\u6EE4\u4E4B\u524D\uFF0C\u6240\u6709\u7684\u5143\u6570\u636E\u8FD8\u662F\u4F1A\u88AB\u67E5\u8BE2\u8FD4\u56DE\uFF0C\u5E76\u4E14\u5360\u7528\u5E26\u5BBD\u3002_source\u8BBE\u7F6E\u4E3Afalse\u4E4B\u540E\uFF0C\u539F\u59CB\u6570\u636E\u4E0D\u4F1A\u8FDB\u884C\u5B58\u50A8\uFF0C\u53EA\u4F1A\u5B58\u50A8\u751F\u6210\u7684\u5012\u6392\u7D22\u5F15\uFF0C\u53EF\u4EE5\u8282\u7701\u78C1\u76D8\uFF0C\u5E76\u4E14\u4E0D\u4F1A\u5F71\u54CD\u641C\u7D22\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&quot;mappings&quot;: {
    &quot;_source&quot;: {
      &quot;enabled&quot;: false
    }
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT my_index
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;store&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;date&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;store&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;date&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+r+'" alt="image-20210821094004061"></p><p>\u7981\u7528source\u4E4B\u540E\u5E26\u6765\u7684\u95EE\u9898\uFF1A</p><ol><li>update\uFF0Cupdate_by_query\u548Creindex\u4E0D\u53EF\u7528\u3002</li><li>\u9AD8\u4EAE\u5931\u6548</li><li>reindex\u5931\u6548\uFF0C\u539F\u672C\u53EF\u4EE5\u4FEE\u6539\u7684mapping\u90E8\u5206\u53C2\u6570\u5C06\u65E0\u6CD5\u4FEE\u6539\uFF0C\u5E76\u4E14\u65E0\u6CD5\u5347\u7EA7\u7D22\u5F15\u3002</li><li>\u65E0\u6CD5\u67E5\u770B\u5143\u6570\u636E\u548C\u805A\u5408\u641C\u7D22\u3002</li><li>\u5F71\u54CD\u7D22\u5F15\u7684\u5BB9\u707E\u80FD\u529B\u3002 \u5982\u679C\u662F\u51FA\u4E8E\u8282\u7701\u78C1\u76D8\u7A7A\u95F4\u7684\u76EE\u7684\uFF0C\u53EF\u4EE5\u8003\u8651\u538B\u7F29\u5143\u6570\u636E\uFF08LZ4\u538B\u7F29\uFF09\u3002\u4F46\u662F\u4F1A\u635F\u5931\u6027\u80FD\u3002</li></ol></li></ol></li>',1),L=s(`<h4 id="dynamic" tabindex="-1"><a class="header-anchor" href="#dynamic" aria-hidden="true">#</a> dynamic</h4><ul><li><p>properties\u540C\u7EA7\u522B\uFF0C\u7528\u4E8E\u8BBE\u7F6E\u662F\u5426\u53EF\u4EE5\u52A8\u6001\u6DFB\u52A0\u5B57\u6BB5\u3002</p></li><li><p>true \u65B0\u68C0\u6D4B\u5230\u7684\u5B57\u6BB5\u5C06\u6DFB\u52A0\u5230\u6620\u5C04\u4E2D\u3002\uFF08\u9ED8\u8BA4\uFF09</p></li><li><p>false \u65B0\u68C0\u6D4B\u5230\u7684\u5B57\u6BB5\u5C06\u88AB\u5FFD\u7565\u3002\u8FD9\u4E9B\u5B57\u6BB5\u5C06\u4E0D\u4F1A\u88AB\u7D22\u5F15\uFF0C\u56E0\u6B64\u5C06\u65E0\u6CD5\u641C\u7D22\uFF0C\u4F46\u4ECD\u4F1A\u51FA\u73B0\u5728_source\u8FD4\u56DE\u7684\u5339\u914D\u9879\u4E2D\u3002\u8FD9\u4E9B\u5B57\u6BB5\u4E0D\u4F1A\u6DFB\u52A0\u5230\u6620\u5C04\u4E2D\uFF0C\u5FC5\u987B\u663E\u5F0F\u6DFB\u52A0\u65B0\u5B57\u6BB5\u3002</p></li><li><p>strict \u5982\u679C\u68C0\u6D4B\u5230\u65B0\u5B57\u6BB5\uFF0C\u5219\u4F1A\u5F15\u53D1\u5F02\u5E38\u5E76\u62D2\u7EDD\u6587\u6863\u3002\u5FC5\u987B\u5C06\u65B0\u5B57\u6BB5\u663E\u5F0F\u6DFB\u52A0\u5230\u6620\u5C04\u4E2D\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;field_1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;boost&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">&quot;dynamic&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="doc-values\u548Cfielddata" tabindex="-1"><a class="header-anchor" href="#doc-values\u548Cfielddata" aria-hidden="true">#</a> doc_values\u548Cfielddata</h4><ul><li><p>doc_values\u548Cfielddata\u5747\u662F\u4E3A\u521B\u5EFA\u6B63\u6392\u7D22\u5F15\u670D\u52A1\u7684\u3002</p></li><li><p>\u5012\u6392\u7D22\u5F15\uFF1A\u67E5\u8BE2\u67D0\u4E2A\u5173\u952E\u8BCD\u5728\u54EA\u4E9B\u6587\u6863\u4E2D\u5B58\u5728\u3002</p></li><li><p>\u6B63\u6392\u7D22\u5F15\uFF1A\u67E5\u8BE2\u67D0\u4E2A\u6587\u6863\u4E2D\u5305\u542B\u54EA\u4E9B\u9879\u3002</p></li><li><p>doc_values\u7684\u4F18\u52BF\u662F\u4ED6\u4E0D\u4F1A\u968F\u7740\u6587\u6863\u7684\u589E\u591A\u5F15\u8D77OOM\u95EE\u9898\u3002doc_values\u5728\u78C1\u76D8\u521B\u5EFA\u6392\u5E8F\u548C\u805A\u5408\u6240\u9700\u7684\u6B63\u6392\u7D22\u5F15\u3002\u8FD9\u6837\u5C31\u907F\u514D\u4E86\u5728\u751F\u4EA7\u73AF\u5883\u7ED9ES\u8BBE\u7F6E\u4E00\u4E2A\u5F88\u5927\u7684HEAP_SIZE\uFF0C\u4E5F\u4F7F\u5F97JVM\u7684GC\u66F4\u52A0\u9AD8\u6548\uFF0C\u8FD9\u4E2A\u53C8\u4E3A\u5176\u5B83\u7684\u64CD\u4F5C\u5E26\u6765\u4E86\u95F4\u63A5\u7684\u597D\u5904\u3002\u800C\u4E14\uFF0C\u968F\u7740ES\u7248\u672C\u7684\u5347\u7EA7\uFF0C\u5BF9\u4E8Edoc_values\u7684\u4F18\u5316\u8D8A\u6765\u8D8A\u597D\uFF0C\u7D22\u5F15\u7684\u901F\u5EA6\u5DF2\u7ECF\u5F88\u63A5\u8FD1fielddata\u4E86\uFF0C\u800C\u4E14\u786C\u76D8\u7684\u8BBF\u95EE\u901F\u5EA6\u4E5F\u662F\u8D8A\u6765\u8D8A\u5FEB\uFF08\u6BD4\u5982SSD\uFF09\u3002\u6240\u4EE5doc_values \u73B0\u5728\u53EF\u4EE5\u6EE1\u8DB3\u5927\u90E8\u5206\u573A\u666F\uFF0C\u4E5F\u662FES\u5B98\u65B9\u91CD\u70B9\u7EF4\u62A4\u7684\u5BF9\u8C61\u3002</p></li><li><p>fileddata\u662F\u5728\u4F7F\u7528\u65F6\u521B\u5EFA\u3001\u57FA\u4E8E\u5185\u5B58\u7684\u6B63\u6392\u7D22\u5F15\u3002</p><table><thead><tr><th>\u7EF4\u5EA6</th><th>doc_values</th><th>fielddata</th></tr></thead><tbody><tr><td>\u521B\u5EFA\u65F6\u95F4</td><td>index\u65F6\u521B\u5EFA</td><td>\u4F7F\u7528\u65F6\u52A8\u6001\u521B\u5EFA</td></tr><tr><td>\u521B\u5EFA\u4F4D\u7F6E</td><td>\u78C1\u76D8</td><td>\u5185\u5B58(jvm heap)</td></tr><tr><td>\u4F18\u70B9</td><td>\u4E0D\u5360\u7528\u5185\u5B58\u7A7A\u95F4</td><td>\u4E0D\u5360\u7528\u78C1\u76D8\u7A7A\u95F4</td></tr></tbody></table></li></ul><h3 id="_1-3\u3001aliases" tabindex="-1"><a class="header-anchor" href="#_1-3\u3001aliases" aria-hidden="true">#</a> 1.3\u3001Aliases</h3><ul><li><p>\u4E3A\u7D22\u5F15\u521B\u5EFA\u522B\u540D\uFF0C\u641C\u7D22\u65F6\u4E5F\u53EF\u4EE5\u4F7F\u7528\u522B\u540D\u8FDB\u884C\u641C\u7D22\u3002\u5E76\u4E14\u521B\u5EFA\u522B\u540D\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u8BBE\u7F6Efilter\u6761\u4EF6\u3002\u8FD9\u6837\u76F4\u63A5\u4F7F\u7528\u522B\u540D\u67E5\u8BE2\u7684\u65F6\u5019\uFF0C\u5C31\u53EF\u4EE5\u67E5\u8BE2\u5230filter\u540E\u7684\u6570\u636E\u4E86\u3002</p></li><li><p>\u5728\u521B\u5EFA\u7D22\u5F15\u7684\u65F6\u5019\u521B\u5EFA\u522B\u540D</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT product
<span class="token punctuation">{</span>
  <span class="token property">&quot;aliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;my_aliase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;FIELD&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VALUE&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u5728\u5DF2\u5B58\u5728\u7684\u7D22\u5F15\u4E0A\u521B\u5EFA\u522B\u540D</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT product/_alias/price
<span class="token punctuation">{</span>
  <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4399&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u4F7F\u7528\u522B\u540D\u8FDB\u884C\u67E5\u8BE2</p><p>\u5982\u679C\u522B\u540D\u8BBE\u7F6E\u4E86filter\uFF0C\u5219\u5C06\u4F1A\u67E5\u8BE2\u5230filter\u4E4B\u540E\u7684\u7ED3\u679C\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET price/_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h2 id="\u4E8C\u3001\u7D22\u5F15\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u7D22\u5F15\u67E5\u8BE2" aria-hidden="true">#</a> \u4E8C\u3001\u7D22\u5F15\u67E5\u8BE2</h2><ul><li><p>\u67E5\u8BE2\u6240\u6709</p><p>\u67E5\u8BE2ES\u4E2D\u5B58\u5728\u7684\u6240\u6709\u7684\u7D22\u5F15\uFF0C\u7C7B\u4F3C\u4E8EMySQL\u4E2D\u7684show table\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET _cat/indices?v  _cat\u8868\u793A\u67E5\u770B\u7684\u542B\u4E49\uFF0Cindices\u8868\u793A\u7D22\u5F15\u7684\u96C6\u5408
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+d+'" alt=""></p><p><img src="'+v+`" alt=""></p></li><li><p>\u67E5\u8BE2\u5355\u6761</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET product(product\u4E3A\u7D22\u5F15name)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+m+'" alt=""></p><p><img src="'+k+`" alt=""></p></li></ul><h2 id="\u4E09\u3001\u7D22\u5F15\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u7D22\u5F15\u4FEE\u6539" aria-hidden="true">#</a> \u4E09\u3001\u7D22\u5F15\u4FEE\u6539</h2><p>\u5DF2\u7ECF\u5B58\u5728\u7684\u5C5E\u6027\u5B57\u6BB5\uFF0C\u4E0D\u80FD\u4FEE\u6539type\u3001analyzer\u3002\u53EA\u80FD\u4FEE\u6539fielddata\u8FD9\u79CD\u9644\u5C5E\u7684\u914D\u7F6E\u4FE1\u606F\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT product/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fielddata&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u56DB\u3001\u7D22\u5F15\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u7D22\u5F15\u5220\u9664" aria-hidden="true">#</a> \u56DB\u3001\u7D22\u5F15\u5220\u9664</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DELETE product(\u7D22\u5F15name)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="\u4E94\u3001cat\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001cat\u547D\u4EE4" aria-hidden="true">#</a> \u4E94\u3001cat\u547D\u4EE4</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>/_cat/allocation      	<span class="token comment">#\u67E5\u770B\u5355\u8282\u70B9\u7684shard\u5206\u914D\u6574\u4F53\u60C5\u51B5</span>
/_cat/shards          <span class="token comment">#\u67E5\u770B\u5404shard\u7684\u8BE6\u7EC6\u60C5\u51B5</span>
/_cat/shards/<span class="token punctuation">{</span>index<span class="token punctuation">}</span>  	<span class="token comment">#\u67E5\u770B\u6307\u5B9A\u5206\u7247\u7684\u8BE6\u7EC6\u60C5\u51B5</span>
/_cat/master          <span class="token comment">#\u67E5\u770Bmaster\u8282\u70B9\u4FE1\u606F</span>
/_cat/nodes           <span class="token comment">#\u67E5\u770B\u6240\u6709\u8282\u70B9\u4FE1\u606F</span>
/_cat/indices         <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u4E2D\u6240\u6709index\u7684\u8BE6\u7EC6\u4FE1\u606F</span>
/_cat/indices/<span class="token punctuation">{</span>index<span class="token punctuation">}</span> 	<span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u4E2D\u6307\u5B9Aindex\u7684\u8BE6\u7EC6\u4FE1\u606F</span>
/_cat/segments        <span class="token comment">#\u67E5\u770B\u5404index\u7684segment\u8BE6\u7EC6\u4FE1\u606F,\u5305\u62ECsegment\u540D, \u6240\u5C5Eshard, \u5185\u5B58(\u78C1\u76D8)\u5360\u7528\u5927\u5C0F, \u662F\u5426\u5237\u76D8</span>
/_cat/segments/<span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token comment">#\u67E5\u770B\u6307\u5B9Aindex\u7684segment\u8BE6\u7EC6\u4FE1\u606F</span>
/_cat/count           <span class="token comment">#\u67E5\u770B\u5F53\u524D\u96C6\u7FA4\u7684doc\u6570\u91CF</span>
/_cat/count/<span class="token punctuation">{</span>index<span class="token punctuation">}</span>   <span class="token comment">#\u67E5\u770B\u6307\u5B9A\u7D22\u5F15\u7684doc\u6570\u91CF</span>
/_cat/recovery        <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u5185\u6BCF\u4E2Ashard\u7684recovery\u8FC7\u7A0B.\u8C03\u6574replica\u3002</span>
/_cat/recovery/<span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token comment">#\u67E5\u770B\u6307\u5B9A\u7D22\u5F15shard\u7684recovery\u8FC7\u7A0B</span>
/_cat/health          <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u5F53\u524D\u72B6\u6001\uFF1A\u7EA2\u3001\u9EC4\u3001\u7EFF</span>
/_cat/pending_tasks   <span class="token comment">#\u67E5\u770B\u5F53\u524D\u96C6\u7FA4\u7684pending task</span>
/_cat/aliases         <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u4E2D\u6240\u6709alias\u4FE1\u606F,\u8DEF\u7531\u914D\u7F6E\u7B49</span>
/_cat/aliases/<span class="token punctuation">{</span>alias<span class="token punctuation">}</span> <span class="token comment">#\u67E5\u770B\u6307\u5B9A\u7D22\u5F15\u7684alias\u4FE1\u606F</span>
/_cat/thread_pool     <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u5404\u8282\u70B9\u5185\u90E8\u4E0D\u540C\u7C7B\u578B\u7684threadpool\u7684\u7EDF\u8BA1\u4FE1\u606F,</span>
/_cat/plugins         <span class="token comment">#\u67E5\u770B\u96C6\u7FA4\u5404\u4E2A\u8282\u70B9\u4E0A\u7684plugin\u4FE1\u606F</span>
/_cat/fielddata       <span class="token comment">#\u67E5\u770B\u5F53\u524D\u96C6\u7FA4\u5404\u4E2A\u8282\u70B9\u7684fielddata\u5185\u5B58\u4F7F\u7528\u60C5\u51B5</span>
/_cat/fielddata/<span class="token punctuation">{</span>fields<span class="token punctuation">}</span>     <span class="token comment">#\u67E5\u770B\u6307\u5B9Afield\u7684\u5185\u5B58\u4F7F\u7528\u60C5\u51B5,\u91CC\u9762\u4F20field\u5C5E\u6027\u5BF9\u5E94\u7684\u503C</span>
/_cat/nodeattrs              <span class="token comment">#\u67E5\u770B\u5355\u8282\u70B9\u7684\u81EA\u5B9A\u4E49\u5C5E\u6027</span>
/_cat/repositories           <span class="token comment">#\u8F93\u51FA\u96C6\u7FA4\u4E2D\u6CE8\u518C\u5FEB\u7167\u5B58\u50A8\u5E93</span>
/_cat/templates              <span class="token comment">#\u8F93\u51FA\u5F53\u524D\u6B63\u5728\u5B58\u5728\u7684\u6A21\u677F\u4FE1\u606F</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u516D\u3001\u7D22\u5F15\u5E38\u7528\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u7D22\u5F15\u5E38\u7528\u64CD\u4F5C" aria-hidden="true">#</a> \u516D\u3001\u7D22\u5F15\u5E38\u7528\u64CD\u4F5C</h2><ol><li><p>\u5224\u65AD\u7D22\u5F15\u662F\u5426\u5B58\u5728\uFF1AHEAD /my_target_index</p><p>\u5B58\u5728\u8FD4\u56DE200\uFF0C\u4E0D\u5B58\u5728\u5219\u8FD4\u56DE404.</p></li><li><p>\u5173\u95ED/\u6253\u5F00\u7D22\u5F15</p><ul><li><p>POST my_index/_close</p><p>\u5173\u95ED\u4E4B\u540E\uFF0C\u5C06\u4E0D\u5141\u8BB8\u8FDB\u884C\u7D22\u5F15\u7684\u589E\u5220\u6539\u67E5\u4E86\u3002</p></li><li><p>POST my_index/_open</p></li></ul></li><li><p>refresh</p><p><img src="`+b+'" alt=""></p><p>ES\u63A5\u6536\u5230\u8BF7\u6C42\uFF0C\u6570\u636E\u4F1A\u76F4\u63A5\u5199\u5165\u5230\u7F13\u5B58buffer\u4E2D\uFF0C\u7136\u540E\u9ED8\u8BA4\u4E00\u79D2\u949F\u4E00\u6B21\uFF0C\u5B9A\u65F6\u5C06buffer\u5199\u5165\u5230segment\u6587\u4EF6\u4E2D\uFF0C\u8FD9\u4E2A\u65F6\u5019segment\u4F1A\u5C06\u641C\u7D22\u72B6\u6001\u6253\u5F00\uFF0C\u5C31\u53EF\u4EE5\u67E5\u8BE2\u5230\u6570\u636E\u4E86\u3002\u53EF\u4EE5\u901A\u8FC7refresh_interval\u914D\u7F6E\u6539\u53D8\u5B9A\u65F6\u65F6\u95F4\uFF0C\u4E5F\u53EF\u4EE5\u624B\u52A8post/index/_refresh\u5C06\u6570\u636E\u5199\u5165\u5230segment\u4E2D\u3002</p></li><li><p>segments</p><p>GET my_index/_segments</p><p>\u53EF\u4EE5\u67E5\u770B\u5F53\u524D\u7D22\u5F15\u7684segments\u76F8\u5173\u4FE1\u606F\uFF0C\u5305\u62ECcommit\u6570\u91CF\u3001num_docs\u6587\u6863\u6570\u91CF\u7B49\u76F8\u5173\u4FE1\u606F\u3002</p><p><img src="'+q+'" alt="image-20210821150410734"></p></li></ol><h2 id="\u4E03\u3001\u7D22\u5F15\u538B\u7F29" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u7D22\u5F15\u538B\u7F29" aria-hidden="true">#</a> \u4E03\u3001\u7D22\u5F15\u538B\u7F29</h2><ul><li><p>\u7D22\u5F15\u538B\u7F29\uFF1A\u5B9E\u9645\u4E0A\u662F\u538B\u7F29\u7684\u5206\u7247\uFF0C\u5E76\u975E\u5728\u539F\u6709\u7D22\u5F15\u4E0A\u538B\u7F29\uFF0C\u800C\u662F\u751F\u6210\u4E86\u4E00\u4E2A\u65B0\u7684\u7D22\u5F15\u3002</p></li><li><p>\u7531\u4E8E\u4F7F\u7528\u4E86hash\u8DEF\u7531\u7B97\u6CD5\u4EE5\u53CA\u7D22\u5F15\u4E0D\u53EF\u53D8\u7684\u7279\u6027\uFF0Ctarget index\u5206\u7247\u6570\u91CF\u5FC5\u987B\u4E3Asource index\u7684\u7EA6\u6570\u3002</p><p>\u6BD4\u5982\u539F\u4E3B\u5206\u7247\u6570\u91CF\u4E3A12\uFF0C\u90A3\u4E48\u76EE\u6807\u4E3B\u5206\u7247\u6570\u91CF\u53EA\u80FD\u662F6\u30014\u30013\u30012\u30011\uFF0C\u5982\u679C\u4E3B\u5206\u7247\u7684\u6570\u91CF\u662F\u8D28\u6570\uFF0C\u90A3\u76EE\u6807\u4E3B\u5206\u7247\u7684\u6570\u91CF\u53EA\u80FD\u662F1\u3002</p></li><li><p>\u80FD\u591F\u8FDB\u884C\u538B\u7F29\u7684\u524D\u63D0\u6761\u4EF6\uFF1A</p><ol><li><p>\u8981\u538B\u7F29\u7684\u7D22\u5F15\u5FC5\u987B\u662F\u53EA\u8BFB</p></li><li><p>target index\u7684\u6240\u6709p shard\u5FC5\u987B\u4F4D\u4E8E\u540C\u4E00\u8282\u70B9\u3002</p></li><li><p>\u7D22\u5F15\u7684\u5065\u5EB7\u72B6\u6001\u5FC5\u987B\u4E3Agreen</p></li><li><p>target index\u4E0D\u80FD\u5DF2\u5B58\u5728</p></li><li><p>\u7D22\u5F15\u7684doc\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC72 147 483 519\u4E2A\uFF0C\u56E0\u4E3A\u5355\u4E2A\u5206\u7247\u6700\u5927\u652F\u6301\u8FD9\u4E48\u591A\u4E2Adoc\u3002</p></li><li><p>\u76EE\u6807\u8282\u70B9\u6240\u5728\u670D\u52A1\u5668\u5FC5\u987B\u6709\u8DB3\u591F\u5927\u7684\u78C1\u76D8\u7A7A\u95F4\u3002</p></li><li><p>target index name\u5FC5\u987B\u6EE1\u8DB3\u4EE5\u4E0B\u6761\u4EF6</p><ul><li>\u4EC5\u5C0F\u5199</li></ul><ol start="2"><li>\u4E0D\u80FD\u5305\u62EC\\\uFF0C/\uFF0C*\uFF0C?\uFF0C&quot;\uFF0C&lt;\uFF0C&gt;\uFF0C|\uFF0C``\uFF08\u7A7A\u683C\u5B57\u7B26\uFF09\uFF0C ,\uFF0C#</li><li>\u7D22\u5F15\u540D\u4E2D\u4E0D\u80FD\u5305\u542B\uFF1A\u5192\u53F7</li><li>\u4E0D\u80FD\u4EE5-\uFF0C_\uFF0C+\u7B49\u7279\u6B8A\u5B57\u7B26\u5F00\u5934</li><li>\u4E0D\u80FD\u8D85\u8FC7255\u4E2A\u5B57\u8282</li><li>\u81EA\u5B9A\u4E49\u7684\u7D22\u5F15\u540D\u79F0\u4E0D\u5EFA\u8BAE\u4F7F\u7528\u4EE5.\u5F00\u5934\u7684\u540D\u79F0</li></ol></li></ol></li><li><p>\u7D22\u5F15\u538B\u7F29\u5B9E\u9645\u6B65\u9AA4\uFF1A</p><p>\u539F\u59CB\u72B6\u6001\uFF1A</p><p><img src="'+g+`" alt="image-20210818230524072"></p><ol><li><p>\u5907\u4EFD\u7D22\u5F15\uFF1A\u9632\u6B62\u5F53\u5220\u9664replicas\u526F\u672C\u5206\u7247\u4E4B\u540E\uFF0C\u4E3B\u5206\u7247\u635F\u574F\uFF0C\u65E0\u6CD5\u56DE\u6EDA\u7684\u95EE\u9898\u3002</p></li><li><p>\u8BBE\u7F6E\u7981\u6B62\u5199\u5165\uFF1A\u9632\u6B62\u7D22\u5F15\u538B\u7F29\u671F\u95F4\u6709\u65B0\u7684\u5199\u5165\u64CD\u4F5C\u3002</p></li><li><p>\u5220\u9664\u526F\u672C\uFF1A\u51CF\u5C11\u6570\u636E\u91CF\uFF0C\u52A0\u5FEB\u7D22\u5F15\u538B\u7F29\u7684\u901F\u5EA6\u3002</p></li><li><p>\u8FC1\u79FB\u4E3B\u5206\u7247\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /my_index/_settings
{
  &quot;settings&quot;: {
    &quot;index.number_of_replicas&quot;: 0,
    &quot;index.routing.allocation.require._name&quot;: &quot;node-1&quot;,
    &quot;index.blocks.write&quot;: true
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.number_of_replicas\uFF1A\u526F\u672C\u5206\u7247\u8BBE\u7F6E\u4E3A0\uFF0CES\u5373\u4F1A\u5220\u9664\u6240\u6709\u7684\u526F\u672C\u5206\u7247\u3002</p><p>index.routing.allocation.require._name: node-1 \u8F6C\u79FB\u5230\u76EE\u6807\u4E3B\u5206\u7247</p><p>index.blocks.write: true \u8BBE\u7F6E\u7981\u6B62\u5199\u5165</p><p>\u51C6\u5907\u5DE5\u4F5C\u505A\u5B8C\uFF0C\u5220\u9664\u4E86\u526F\u672C\u5206\u7247\u3002<img src="`+y+`" alt="image-20210818231243604"></p></li><li><p>\u6267\u884C\u538B\u7F29</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST /my_index/_shrink/my_target_index
{
  &quot;settings&quot;: {
    &quot;index.number_of_replicas&quot;: 1,
    &quot;index.number_of_shards&quot;: 3, 
    &quot;index.codec&quot;: &quot;best_compression&quot; 
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.codec: best_compression \u538B\u7F29\u7B97\u6CD5</p><p>\u538B\u7F29\u540E\u7684\u72B6\u6001\uFF1A\uFF083\u4E2A\u4E3B\u5206\u7247\uFF0C\u6BCF\u4E2A\u4E3B\u5206\u7247\u4E00\u4E2A\u526F\u672C\u5206\u7247\uFF09</p><p><img src="`+_+`" alt="image-20210818231638204"></p></li><li><p>recover\u91CD\u65B0\u5206\u914D\u5206\u7247\u3002</p></li><li><p>\u6062\u590D\u5907\u4EFD\u524D\u7684\u5C5E\u6027\u914D\u7F6E\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT my_target_index/_settings
{
  &quot;index.routing.allocation.require._name&quot;: null,
  &quot;index.blocks.write&quot;: false //\u5173\u95ED\u7981\u6B62\u5199
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>routing\u7684name\u8BBE\u7F6E\u4E3Anull\uFF0CES\u5C31\u4F1A\u91CD\u65B0\u8FDB\u884C\u5206\u7247\u8D1F\u8F7D\u3002</p><p>\u5173\u95ED\u7981\u6B62\u5199</p></li><li><p>\u76D1\u63A7\u538B\u7F29\u8FC7\u7A0B\u3001\u8FDB\u5EA6</p><p>GET _cat/recovery?v</p><p><img src="`+h+`" alt="image-20210818232012355"></p></li></ol></li></ul><h2 id="\u516B\u3001rollover-index" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001rollover-index" aria-hidden="true">#</a> \u516B\u3001rollover index</h2><ul><li><p>\u901A\u8FC7\u522B\u540D\u7684\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u5BF9\u5DF2\u7ECF\u521B\u5EFA\u7684\u7D22\u5F15\u8FDB\u884C\u6570\u636E\u62C6\u5206\uFF0C\u6BD4\u5982\u6309\u7167\u7D22\u5F15\u5927\u5C0F\u3001\u6570\u636E\u91CF\u3001\u65F6\u95F4\u7B49\u7EF4\u5EA6\u8FDB\u884C\u6570\u636E\u62C6\u5206\u3002\u7C7B\u4F3C\u6570\u636E\u5E93\u7684\u5206\u5E93\u5206\u8868\uFF0C\u65E5\u5FD7\u6309\u5929\u8FDB\u884C\u62C6\u5206\u3002\u597D\u5904\u662F\u53EF\u4EE5\u964D\u4F4E\u5355\u4E2A\u7D22\u5F15\u7684\u6570\u636E\u91CF\uFF0C\u63D0\u5347\u6574\u4F53\u67E5\u8BE2\u6548\u7387\u3002</p></li><li><p>\u524D\u63D0\u6761\u4EF6\uFF1A\u8FDB\u884C\u62C6\u5206\u7684\u7D22\u5F15\uFF0C\u5FC5\u987B\u62E5\u6709\u522B\u540D\u3002</p></li><li><p>\u62C6\u5206\u8BED\u53E5</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /my_index
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;logs_write&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
#\u4E3Amy_index\u521B\u5EFA
POST /logs_write/_rollover/my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;max_age&quot;</span><span class="token operator">:</span>   <span class="token string">&quot;7d&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_docs&quot;</span><span class="token operator">:</span>  <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_size&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5gb&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>max_age: 7d\uFF0C\u65F6\u95F4\u7EF4\u5EA6</li><li>max_docs: 2 \u6587\u6863\u6570\u91CF</li><li>max_size: 5gb \u7D22\u5F15\u5927\u5C0F</li><li>\u5F53\u6EE1\u8DB3\u6761\u4EF6\u7684\u65F6\u5019\uFF0C\u6267\u884Crollover\uFF0C\u53EF\u4EE5\u8FDB\u884C\u7D22\u5F15\u62C6\u5206\u3002</li></ol><p><img src="`+x+`" alt="image-20210819211830641"></p></li><li><p>\u6309\u7167\u65F6\u95F4\u7EF4\u5EA6\u8FDB\u884C\u62C6\u5206</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /%3Cmy_index-%7Bnow%2Fd%7D-1%3E
{
  &quot;aliases&quot;: {
    &quot;logs_write&quot;: {}
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u539F\u7D22\u5F15\u6807\u8BC6\u4F7F\u7528url encode\u8FDB\u884C\u7F16\u7801\uFF0C\u6309\u7167\u65F6\u95F4\u683C\u5F0F\u8FDB\u884C\u8BBE\u7F6E\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST /logs_write/_rollover 
{
  &quot;conditions&quot;: {
    &quot;max_docs&quot;:   &quot;0&quot;
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u662F\u4E00\u5929\u6267\u884C\u4E00\u6B21\uFF0C\u7B2C\u4E8C\u5929\u6267\u884C\u7684\u65F6\u5019\uFF0C\u7D22\u5F15\u5C31\u4F1A\u8FDB\u884C\u6309\u5929\u62C6\u5206\u3002</p></li><li><p>rollover\u521B\u5EFA\u65B0\u7684\u7D22\u5F15\u65F6\uFF0C\u4E0D\u4F1A\u4FDD\u7559mapping\u3001setting\u7B49\u76F8\u5173\u8BBE\u7F6E\u3002\u6240\u4EE5\u9700\u8981\u4F7F\u7528index_template\u521B\u5EFA\u7D22\u5F15\u6A21\u677F\u3002</p></li></ul><h2 id="\u4E5D\u3001\u7D22\u5F15\u6A21\u677F" tabindex="-1"><a class="header-anchor" href="#\u4E5D\u3001\u7D22\u5F15\u6A21\u677F" aria-hidden="true">#</a> \u4E5D\u3001\u7D22\u5F15\u6A21\u677F</h2><ul><li><p>\u53EF\u4EE5\u901A\u8FC7index template\u521B\u5EFA\u7D22\u5F15\u6A21\u677F\uFF0C\u4F5C\u7528\u662F\u4E3A\u5339\u914D\u7684\u7D22\u5F15\u521B\u5EFA\u4E00\u4E2A\u6A21\u677F\u3002rollover\u5728\u52A8\u6001\u521B\u5EFA\u7D22\u5F15\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u5229\u7528\u7D22\u5F15\u6A21\u677F\u52A8\u6001\u6307\u5B9Amapping\u3001setting\u7B49\u76F8\u5173\u914D\u7F6E\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST _index_template/template_1
<span class="token punctuation">{</span>
  <span class="token property">&quot;index_patterns&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;daylog*&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;priority&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;template&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;keyword&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u8BBE\u7F6E\u5206\u7247\u3001setting\u3001mapping\u7B49\u4FE1\u606F\u3002\u5F53\u5339\u914D\u5230index_patterns\u6307\u5B9A\u7684\u5173\u952E\u8BCD\u4E4B\u540E\uFF0C\u5C31\u4F1A\u4E3A\u5339\u914D\u5230\u7684\u7D22\u5F15\u4F7F\u7528\u76F8\u5E94\u7684\u6A21\u677F\u8FDB\u884C\u521B\u5EFA\u4E86\u3002</p></li></ul><h2 id="\u5341\u3001stats" tabindex="-1"><a class="header-anchor" href="#\u5341\u3001stats" aria-hidden="true">#</a> \u5341\u3001stats</h2><ul><li><p>\u53EF\u4EE5\u67E5\u770B\u7D22\u5F15\u8D44\u6E90\u7684\u5360\u7528\u60C5\u51B5\u548C\u4E00\u4E9B\u7CFB\u7EDF\u8BB0\u5F55</p><p><img src="`+f+'" alt=""></p></li><li><p>\u901A\u8FC7stats\u53EF\u4EE5\u770B\u5230\u5F53\u524D\u7D22\u5F15\u7684\u6587\u6863\u6570\u636E\u603B\u6570\u3001\u5B58\u50A8\u7A7A\u95F4\u5927\u5C0F\u3001get\u6307\u4EE4\u603B\u6570\u3001search\u603B\u6570\u7B49\u76F8\u5173\u4FE1\u606F\u3002</p></li><li><p>recovery\uFF1Aes\u5B95\u673A\u4E4B\u540E\uFF0COS Cache\u5185\u5B58\u4E2D\u4E00\u90E8\u5206\u6570\u636E\u8FD8\u6CA1\u6301\u4E45\u5316\u5230\u78C1\u76D8\u4E2D\uFF0C\u8FD9\u90E8\u5206\u6570\u636E\u7684\u64CD\u4F5C\u8BB0\u5F55\u4F1A\u8BB0\u5F55\u5728tranlog\u91CC\uFF0Crecovery\u6307\u4EE4\u662F\u53EF\u4EE5\u5728ES\u6062\u590D\u670D\u52A1\u4E4B\u540E\uFF0C\u5C06translog\u91CC\u7684\u6570\u636E\u8FDB\u884C\u6062\u590D\u3002</p></li></ul>',25);function G(F,V){const a=l("ExternalLinkIcon");return p(),o("div",null,[E,n("ul",null,[z,n("li",null,[S,n("ol",null,[T,n("li",null,[w,P,n("p",null,[n("a",U,[A,t(a)]),I,n("a",B,[M,t(a)])])]),N])]),O]),L])}var H=e(j,[["render",G],["__file","03.\u7D22\u5F15.html.vue"]]);export{H as default};
